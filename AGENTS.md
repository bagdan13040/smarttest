# AGENTS.md - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è AI –ê–≥–µ–Ω—Ç–æ–≤

## üìã –û–±–∑–æ—Ä –ü—Ä–æ–µ–∫—Ç–∞

**SmartTest** - –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Kivy –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LLM (Language Model).

### –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ —Ç–µ—Å—Ç—ã –ø–æ –ª—é–±–æ–π —Ç–µ–º–µ, –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ LLM, –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **Framework**: Kivy 2.3.1 (Python GUI)
- **Language**: Python 3.10+
- **LLM Integration**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –º–æ–¥—É–ª—å `llm.py`
- **Storage**: JSON-based (JsonStore, CourseStorage)
- **Target Platform**: Android (—Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Desktop)

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤
```
main.py               # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (~2800 —Å—Ç—Ä–æ–∫)
llm.py               # LLM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
courses.json         # –•—Ä–∞–Ω–∏–ª–∏—â–µ –∫—É—Ä—Å–æ–≤
settings.json        # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
open_questions_cache.json  # –ö–µ—à —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
course_topics.json   # –ò—Å—Ç–æ—Ä–∏—è —Ç–µ–º
assets/              # –ò–∫–æ–Ω–∫–∏ –∏ —Ä–µ—Å—É—Ä—Å—ã
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 1. –≠–∫—Ä–∞–Ω—ã (Screens)
```
MainScreen           ‚Üí –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω —Å —Ç—Ä–µ–º—è —Ç–∞–±–∞–º–∏
‚îú‚îÄ‚îÄ SavedScreen      ‚Üí –°–ø–∏—Å–æ–∫ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –∫—É—Ä—Å–æ–≤
‚îú‚îÄ‚îÄ SearchScreen     ‚Üí –ü–æ–∏—Å–∫ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∫—É—Ä—Å–æ–≤
‚îî‚îÄ‚îÄ SettingsScreen   ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API

LoadingScreen        ‚Üí –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ —Å —Ñ–∞–∫—Ç–∞–º–∏
TheoryScreen         ‚Üí –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–æ—Ä–∏–∏
QuizScreen           ‚Üí MC —Ç–µ—Å—Ç (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä)
OpenAnswerScreen     ‚Üí –†–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–µ –æ—Ç–≤–µ—Ç—ã
FinalScreen          ‚Üí –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç —Å –æ—à–∏–±–∫–∞–º–∏
```

#### 2. –•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö

**CourseStorage** (`courses.json`):
```python
{
  "meta": {
    "topic": "–Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã",
    "difficulty": "–ª–µ–≥–∫–∏–π|—Å—Ä–µ–¥–Ω–∏–π|—ç–∫—Å–ø–µ—Ä—Ç",
    "history": [...],
    "notes": {"quick_hint": "..."}
  },
  "theory": "—Ç–µ–∫—Å—Ç —Ç–µ–æ—Ä–∏–∏",
  "questions": [...],
  "open_questions": [...]
}
```

**–ö–µ—à –æ—Ç–∫—Ä—ã—Ç—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤** (`open_questions_cache.json`):
```python
{
  "—Ç–µ–º–∞|—Å–ª–æ–∂–Ω–æ—Å—Ç—å": [–≤–æ–ø—Ä–æ—Å—ã...],
  "python|–ª–µ–≥–∫–∏–π": [...]
}
```

#### 3. LLM –ú–æ–¥—É–ª—å (llm.py)

**–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:
- `generate_quiz(topic, difficulty, api_key)` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—É—Ä—Å–∞
- `generate_open_questions(topic, n, difficulty, api_key)` - –æ—Ç–∫—Ä—ã—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã
- `evaluate_answer(question, answer, notes, api_key)` - –æ—Ü–µ–Ω–∫–∞ –æ—Ç–≤–µ—Ç–∞
- `generate_next_topics(material, api_key)` - —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Ç–µ–º

**–í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã**:
```python
# generate_quiz
{
  "meta": {...},
  "theory": "...",
  "questions": [{"question": "...", "options": [...], "answer": int}],
  "error": "..." (–µ—Å–ª–∏ –µ—Å—Ç—å)
}

# evaluate_answer
{
  "score": int (0-10),
  "max_score": 10,
  "feedback": "...",
  "suggested_improvements": "..."
}
```

---

## üîÑ –ü–æ—Ç–æ–∫–∏ –î–∞–Ω–Ω—ã—Ö

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫—É—Ä—Å–∞
```
SearchScreen.start_new_quiz()
    ‚Üì
MyApp.generate_quiz_thread() [threading]
    ‚Üì
llm.generate_quiz()
    ‚Üì
MyApp.on_generation_complete()
    ‚Üì
CourseStorage.save()
    ‚Üì
TheoryScreen ‚Üí QuizScreen
```

### 2. –ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞ (—Å –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–æ–π)
```
QuizScreen.on_pre_enter()
    ‚Üì
MyApp.preload_open_questions() [threading, —Ñ–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞]
    ‚îú‚îÄ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–µ—à–∞
    ‚îî‚îÄ‚Üí llm.generate_open_questions() (–µ—Å–ª–∏ –Ω–µ—Ç –≤ –∫–µ—à–µ)
    
–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ:
QuizScreen (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã)
    ‚Üì
QuizScreen.finish_test()
    ‚Üì
MyApp.transition_to_open_questions()
    ‚îú‚îÄ‚Üí –ï—Å–ª–∏ preloaded_open_questions –≥–æ—Ç–æ–≤ ‚Üí —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑–∞—Ç—å
    ‚îî‚îÄ‚Üí –ò–Ω–∞—á–µ ‚Üí LoadingScreen ‚Üí –æ–∂–∏–¥–∞–Ω–∏–µ
```

### 3. –û—Ü–µ–Ω–∫–∞ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
```
OpenAnswerScreen.submit_answer()
    ‚Üì
MyApp.evaluate_answer_thread() [threading]
    ‚Üì
llm.evaluate_answer()
    ‚Üì
MyApp.on_answer_evaluated()
    ‚Üì
–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ open_answers_history
    ‚Üì
OpenAnswerScreen.next_question()
    ‚Üì
MyApp.finish_open_questions()
    ‚Üì
MyApp.show_combined_results() [–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ MC + Open]
    ‚Üì
FinalScreen
```

---

## ‚ö° –ö–ª—é—á–µ–≤—ã–µ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏ (Performance Optimization)

**–ü—Ä–æ–±–ª–µ–º–∞**: –î–æ–ª–≥–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –º–µ–∂–¥—É MC —Ç–µ—Å—Ç–æ–º –∏ –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏.

**–†–µ—à–µ–Ω–∏–µ**: 
- `preload_open_questions()` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ —Ñ–æ–Ω–µ –ø—Ä–∏ –≤—Ö–æ–¥–µ –Ω–∞ QuizScreen
- –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–µ—à: `get_cached_open_questions()`
- –ï—Å–ª–∏ –Ω–µ—Ç –≤ –∫–µ—à–µ ‚Üí –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —á–µ—Ä–µ–∑ LLM
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `preloaded_open_questions`
- `transition_to_open_questions()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

**–ö–æ–¥**:
```python
# –í QuizScreen.on_pre_enter()
threading.Thread(target=app.preload_open_questions, daemon=True).start()

# –í QuizScreen.finish_test()
app.transition_to_open_questions()  # –£–º–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥
```

### 2. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–¶–µ–ª—å**: –ò–∑–±–µ–∂–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤.

**–ö–ª—é—á –∫–µ—à–∞**: `"{topic.lower()}|{difficulty}"`

**–ú–µ—Ç–æ–¥—ã**:
- `_load_open_questions_cache()` - –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- `cache_open_questions()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- `get_cached_open_questions()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ –∫–µ—à–∞
- `_save_open_questions_cache()` - –∑–∞–ø–∏—Å—å –Ω–∞ –¥–∏—Å–∫

### 3. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞**:
```python
combined_errors = [
    # –ó–∞–≥–æ–ª–æ–≤–æ–∫ MC —Å–µ–∫—Ü–∏–∏
    {"question": "‚ïê‚ïê‚ïê –†–ê–ë–û–¢–ê –ù–ê–î –û–®–ò–ë–ö–ê–ú–ò: –¢–ï–°–¢–û–í–ê–Ø –ß–ê–°–¢–¨ ‚ïê‚ïê‚ïê", ...},
    # –û—à–∏–±–∫–∏ MC
    {"question": "...", "correct": "...", "selected": "..."},
    
    # –í–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
    {"divider": True},  # ‚Üí SectionDivider widget
    
    # –ó–∞–≥–æ–ª–æ–≤–æ–∫ Open —Å–µ–∫—Ü–∏–∏
    {"question": "‚ïê‚ïê‚ïê –†–ê–ë–û–¢–ê –ù–ê–î –û–®–ò–ë–ö–ê–ú–ò: –†–ê–ó–í–Å–†–ù–£–¢–´–ï –û–¢–í–ï–¢–´ ‚ïê‚ïê‚ïê", ...},
    # –û—à–∏–±–∫–∏ Open
    {...}
]
```

**–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤ FinalScreen**:
```python
for item in errors:
    if item.get('divider'):
        layout.add_widget(SectionDivider())  # –°–∏–Ω—è—è –ª–∏–Ω–∏—è dp(3)
    else:
        layout.add_widget(Label(...))  # –û–±—ã—á–Ω–∞—è –æ—à–∏–±–∫–∞
```

### 4. –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å

**–õ–æ–≥–∏–∫–∞**:
```python
def adjust_difficulty(percent):
    if percent >= 80:  # –•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        difficulty += 1  # –ª–µ–≥–∫–∏–π ‚Üí —Å—Ä–µ–¥–Ω–∏–π ‚Üí —ç–∫—Å–ø–µ—Ä—Ç
    elif percent <= 40:  # –ü–ª–æ—Ö–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        difficulty -= 1  # —ç–∫—Å–ø–µ—Ä—Ç ‚Üí —Å—Ä–µ–¥–Ω–∏–π ‚Üí –ª–µ–≥–∫–∏–π
```

### 5. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ Threading

**–í—Å–µ –¥–æ–ª–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–∞—Ö**:
- `generate_quiz_thread()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—É—Ä—Å–∞
- `preload_open_questions()` - –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞
- `evaluate_answer_thread()` - –æ—Ü–µ–Ω–∫–∞ –æ—Ç–≤–µ—Ç–∞
- `MainScreen.check_network()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏

**–í–æ–∑–≤—Ä–∞—Ç –≤ –≥–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫**:
```python
Clock.schedule_once(lambda dt: self.on_complete(result))
```

---

## üé® UI/UX –ü–∞—Ç—Ç–µ—Ä–Ω—ã

### –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞
```python
PRIMARY_BLUE = (0.15, 0.55, 0.9, 1)   # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∏–Ω–∏–π
BACKGROUND = (0.95, 0.93, 0.90, 1)    # –¢—ë–ø–ª—ã–π —Å–≤–µ—Ç–ª—ã–π —Ñ–æ–Ω
SUCCESS_GREEN = (0.3, 0.7, 0.3, 1)
ERROR_RED = (0.9, 0.3, 0.3, 1)
TEXT_DARK = (0.2, 0.2, 0.2, 1)
```

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –≤–∏–¥–∂–µ—Ç—ã

**RoundedButton** - –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:
```python
bg_color = ListProperty([...])  # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π —Ü–≤–µ—Ç
radius = [dp(14)]
```

**IconToggleButton** - –Ω–∞–≤–∏–≥–∞—Ü–∏—è:
```python
active_color = PRIMARY_BLUE
inactive_color = GRAY
# –ú–µ–Ω—è–µ—Ç —Ü–≤–µ—Ç –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏
```

**SectionDivider** - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–π:
```python
# –¢–æ–ª—Å—Ç–∞—è —Å–∏–Ω—è—è –ª–∏–Ω–∏—è dp(3)
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ FinalScreen –º–µ–∂–¥—É MC –∏ Open
```

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –≤—ã—Å–æ—Ç—ã

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–∞–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ –¥–ª–∏–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫–∞—Ö.

**–†–µ—à–µ–Ω–∏–µ**:
```python
label.bind(texture_size=lambda inst, size: setattr(inst, 'height', size[1] + dp(24)))
label.bind(width=lambda inst, w: setattr(inst, 'text_size', (w - dp(24), None)))
```

### –û—Ç—Å—Ç—É–ø—ã –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

**FinalScreen ScrollView**:
```python
padding: [0, dp(12), 0, dp(120)]  # –ù–∏–∂–Ω–∏–π –æ—Ç—Å—Ç—É–ø –¥–ª—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
```

---

## üîß –°–æ–≤–µ—Ç—ã –ø–æ –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —ç–∫—Ä–∞–Ω–∞

1. **–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å**:
```python
class NewScreen(Screen):
    pass
```

2. **–î–æ–±–∞–≤–∏—Ç—å –≤ KV**:
```python
KV = """
ScreenManager:
    MainScreen:
    NewScreen:  # –î–æ–±–∞–≤–∏—Ç—å –∑–¥–µ—Å—å
    ...
"""
```

3. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å UI –≤ KV**:
```python
<NewScreen>:
    name: 'new_screen'
    BoxLayout:
        ...
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–∏–º–µ—Ä**: –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–∏–ø –≤–æ–ø—Ä–æ—Å–æ–≤

1. –†–∞—Å—à–∏—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤ `llm.py`:
```python
def generate_new_question_type(topic, api_key):
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è
    return {...}
```

2. –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à:
```python
self.new_questions_cache = {}
```

3. –°–æ–∑–¥–∞—Ç—å —ç–∫—Ä–∞–Ω:
```python
class NewQuestionScreen(Screen):
    pass
```

4. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –ø–æ—Ç–æ–∫:
```python
# –ü–æ—Å–ª–µ OpenAnswerScreen
app.start_new_question_type()
```

### –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è LLM –ø—Ä–æ–º–ø—Ç–æ–≤

**–í—Å–µ –ø—Ä–æ–º–ø—Ç—ã –≤ `llm.py`** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤**:
```python
# –í Python –∫–æ–Ω—Å–æ–ª–∏
from llm import generate_quiz
result = generate_quiz("Python", "–ª–µ–≥–∫–∏–π", api_key="...")
print(result)
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

1. **–î–æ–±–∞–≤–∏—Ç—å –≤ SettingsScreen (KV)**:
```python
<SettingsScreen>:
    BoxLayout:
        TextInput:
            id: new_setting_input
```

2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**:
```python
def save_settings():
    new_value = settings_screen.ids.new_setting_input.text
    self.settings_store.put('settings', new_key=new_value)
```

3. **–ó–∞–≥—Ä—É–∑–∫–∞**:
```python
def load_settings_ui():
    if self.settings_store.exists('settings'):
        data = self.settings_store.get('settings')
        value = data.get('new_key', 'default')
```

---

## üêõ –¢–∏–ø–∏—á–Ω—ã–µ –ü—Ä–æ–±–ª–µ–º—ã –∏ –†–µ—à–µ–Ω–∏—è

### 1. "–í–æ–ø—Ä–æ—Å—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è"

**–ü—Ä–∏—á–∏–Ω–∞**: –ö–µ—à –ø–æ–≤—Ä–µ–∂–¥—ë–Ω –∏–ª–∏ LLM –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç.

**–†–µ—à–µ–Ω–∏–µ**:
```python
# –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à
os.remove('open_questions_cache.json')

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å LLM
result = generate_quiz("test", "–ª–µ–≥–∫–∏–π", api_key="...")
print(result.get('error'))
```

### 2. "–¢–µ–∫—Å—Ç –Ω–∞–µ–∑–∂–∞–µ—Ç –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞"

**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≤—ã—Å–æ—Ç–∞.

**–†–µ—à–µ–Ω–∏–µ**:
```python
label.bind(texture_size=lambda inst, size: setattr(inst, 'height', size[1] + dp(padding)))
```

### 3. "–ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"

**–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ—Ç–æ–∫ –Ω–µ —É—Å–ø–µ–ª –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è.

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```python
# –í QuizScreen.finish_test()
print(f"Preloaded: {hasattr(app, 'preloaded_open_questions')}")
```

### 4. "–ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–µ –≤–∏–¥–Ω–∞"

**–ü—Ä–∏—á–∏–Ω–∞**: –ó–∞–±—ã–ª–∏ –∑–∞–¥–∞—Ç—å –æ—Ç—Å—Ç—É–ø –≤ ScrollView.

**–†–µ—à–µ–Ω–∏–µ**:
```python
padding: [0, dp(12), 0, dp(120)]  # –£–≤–µ–ª–∏—á–∏—Ç—å –Ω–∏–∂–Ω–∏–π –æ—Ç—Å—Ç—É–ø
```

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∏ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏

- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—É—Ä—Å–∞**: ~5-15 —Å–µ–∫ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç LLM)
- **–ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤**: ~3-8 —Å–µ–∫ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å MC —Ç–µ—Å—Ç–æ–º)
- **–û—Ü–µ–Ω–∫–∞ –æ–¥–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞**: ~2-5 —Å–µ–∫

### –†–∞–∑–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö

- `courses.json`: ~10-50 KB –Ω–∞ –∫—É—Ä—Å
- `open_questions_cache.json`: ~5-20 KB –Ω–∞ —Ç–µ–º—É
- –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: ~15-20 MB (—Å Kivy)

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∏–∑–±–µ–≥–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö LLM –∑–∞–ø—Ä–æ—Å–æ–≤
2. **–ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞** - —Å–∫—Ä—ã–≤–∞–µ—Ç –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
3. **Threading** - –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç UI
4. **–ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã** - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π JSON

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### API –ö–ª—é—á–∏
- –•—Ä–∞–Ω—è—Ç—Å—è –≤ `settings.json` (–ª–æ–∫–∞–ª—å–Ω–æ)
- –ù–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ UI –Ω–∞–ø—Ä—è–º—É—é
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ LLM –∑–∞–ø—Ä–æ—Å–∞—Ö

### –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ (JSON —Ñ–∞–π–ª—ã)
- –ù–µ—Ç –æ–±–ª–∞—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –î–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

---

## üöÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Android (Buildozer)
```bash
buildozer android debug
buildozer android deploy run
```

### Desktop (Dev)
```bash
python main.py
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```
kivy==2.3.1
requests  # –î–ª—è LLM API
```

---

## üìù –ö–æ–Ω–≤–µ–Ω—Ü–∏–∏ –ö–æ–¥–∞

### –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ
- **–ö–ª–∞—Å—Å—ã**: PascalCase (`QuizScreen`, `CourseStorage`)
- **–ú–µ—Ç–æ–¥—ã**: snake_case (`load_question`, `on_answer_evaluated`)
- **–ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã**: `_method_name` (`_update_rect`, `_save_cache`)
- **KV ids**: snake_case (`answer_input`, `action_button`)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ—Ç–æ–¥–æ–≤
```python
def method_name(self, arg1, arg2):
    """
    –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∞.
    
    Args:
        arg1: –û–ø–∏—Å–∞–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞
        arg2: –û–ø–∏—Å–∞–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞
        
    Returns:
        –û–ø–∏—Å–∞–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
    """
    # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
```

### –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- **Docstrings** –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤ –∏ –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
- **Inline –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** –¥–ª—è —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏
- **–°–µ–∫—Ü–∏–æ–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏** —Å `# ===` –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

---

## üéØ Roadmap –∏ TODO

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- [ ] –û–±–ª–∞—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫—É—Ä—Å–æ–≤
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- [ ] –ì—Ä–∞—Ñ–∏–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- [ ] –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ PDF
- [ ] –†–µ–∂–∏–º –æ—Ñ—Ñ–ª–∞–π–Ω (–ª–æ–∫–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã)
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –≤–æ–ø—Ä–æ—Å–∞—Ö
- [ ] –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ –æ—Ç–≤–µ—Ç–æ–≤
- [ ] –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç LLM API (–Ω—É–∂–µ–Ω –∏–Ω—Ç–µ—Ä–Ω–µ—Ç)
- –ù–µ—Ç –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç–∏ (—Ç–æ–ª—å–∫–æ —Ä—É—Å—Å–∫–∏–π)
- –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ

---

## üìñ –ü–æ–ª–µ–∑–Ω—ã–µ –°—Å—ã–ª–∫–∏

- [Kivy Documentation](https://kivy.org/doc/stable/)
- [Buildozer Documentation](https://buildozer.readthedocs.io/)
- [KV Language Guide](https://kivy.org/doc/stable/guide/lang.html)

---

## ü§ù –î–ª—è AI –ê–≥–µ–Ω—Ç–æ–≤

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —ç—Ç–∏–º –ø—Ä–æ–µ–∫—Ç–æ–º:

1. **–í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å**: `python -m py_compile main.py`
2. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö**: –ü—Ä–æ—Å–ª–µ–¥–∏—Ç–µ –ø—É—Ç—å –æ—Ç UI ‚Üí LLM ‚Üí Storage ‚Üí UI
3. **–£—á–∏—Ç—ã–≤–∞–π—Ç–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å**: Threading + Clock.schedule_once –¥–ª—è UI –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
4. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –°—Ç–∞—Ä—ã–µ –∫—É—Ä—Å—ã –≤ `courses.json` –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å
5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è**: –û–±–Ω–æ–≤–ª—è–π—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø—Ä–∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ª–æ–≥–∏–∫–∏
6. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫—É—Ä—Å ‚Üí –ü—Ä–æ—Ö–æ–¥–∏—Ç–µ —Ç–µ—Å—Ç ‚Üí –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –æ—Ç—á—ë—Ç

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–æ–Ω—ã
- **–ù–µ –ª–æ–º–∞—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - —ç—Ç–æ –∫–ª—é—á–µ–≤–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- **–ù–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å UI –ø–æ—Ç–æ–∫** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ threading
- **–ù–µ –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É JSON** –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏
- **–ù–µ —É–¥–∞–ª—è—Ç—å –ø—Ä–∏–≤—è–∑–∫–∏ (bind)** - –æ–Ω–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**: 1.0  
**–î–∞—Ç–∞**: 2026-01-02  
**–†–∞–∑–º–µ—Ä –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã**: ~2800 —Å—Ç—Ä–æ–∫ (main.py) + llm.py
